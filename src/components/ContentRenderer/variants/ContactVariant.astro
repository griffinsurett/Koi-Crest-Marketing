---
// src/components/ContentRenderer/variants/ContactVariant.astro
/**
 * Contact Variant - Contact information with social media
 * Features: Contact cards, embedded social media section, 1-3 columns
 */
import ContentRenderer from "../ContentRenderer.astro";
import type { BaseVariantProps } from "../ContentRenderer.types";
import ContactCard from "@/components/LoopComponents/ContactCard.astro";
import Button from "@/components/Button/Button";
import { query } from "@/utils/query";
import { shouldShowCollectionCTA } from "../utils/helpers";
import ContactForm from "@/components/Form/forms/ContactForm";

interface Props extends BaseVariantProps {
  columns?: 1 | 2 | 3;
}

const {
  items = [],
  title,
  description,
  className = "",
  columns = 2,
  collectionUrl,
  collectionTitle,
  id,
} = Astro.props as Props;

const viewAllText = `Contact Us`;

const columnClasses = {
  1: "grid-cols-1",
  2: "grid-cols-1 md:grid-cols-2",
  3: "grid-cols-1 md:grid-cols-2 lg:grid-cols-3",
};
---

<section id={id} class={`py-16 w-full ${className}`}>
  <div class="flex flex-col-reverse lg:flex-row">
    <div class="px-4">
      {
        items.length > 0 && (
          <ul class={`flex flex-col gap-6 list-none`}>
            {items.map((item) => {
              const linkPrefix = item.linkPrefix ?? item.data?.linkPrefix;
              const title = item.title ?? item.data?.title;
              const url = item.url ?? (linkPrefix ? `${linkPrefix}${title}` : undefined);
              return (
                <li>
                  <ContactCard {...item} href={url} title={title} />
                </li>
              );
            })}
          </ul>
        )
      }

      {
        shouldShowCollectionCTA(collectionUrl, items.length) && (
          <div class="mt-12 text-left">
            <Button
              href={collectionUrl}
              rightIcon="lu:arrow-right"
              variant="primary"
              size="lg"
            >
              {viewAllText}
            </Button>
          </div>
        )
      }
    </div>
    <div class="flex flex-col items-start w-full">
      <ContactForm client:visible />
      <ContentRenderer
        query={query("social-media")}
        variant="SocialMediaVariant"
        title="Follow Us"
        size="lg"
        alignment="center"
      />
    </div>
  </div>
</section>
