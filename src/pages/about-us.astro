---
// src/pages/about.astro
import BaseLayout from "@/layouts/BaseLayout.astro";
import ContentRenderer from "@/components/ContentRenderer/ContentRenderer.astro";
import { siteData } from "@/content/siteData";
import {
  query,
  sortByDate,
  sortByOrder,
  whereArrayContains,
} from "@/utils/query";
import MainHero from "@/layouts/MainHero.astro";
import AboutSection from "@/layouts/AboutSection.astro";
import CTASection from "@/layouts/CTASection.astro";
import SecondaryHero from "@/layouts/SecondaryHero.astro";
import aboutPageImage from "@/assets/template-2.png";
---

<BaseLayout
  title={`${siteData.title} - home`}
  description={siteData.description}
>
  <main class="flex-1">
    <!-- Hero ContentRenderer with static content -->
    <SecondaryHero
      title={"About " + siteData.title}
      description={siteData.description}
      subtitle={siteData.tagline}
      primaryCTA={{
        text: "Get Started",
        link: "/contact-us",
      }}
      secondaryCTA={{
        text: "View Services",
        link: "/services",
      }}
    />

    <AboutSection
      subtitle="About Us"
      title="We're Contractors First. Marketers Second."
      description={`We didn't start as a marketing agency — we started as roofers. Koi Roofing and Solar is our company, and we built this marketing system to grow it. After seeing what actually works in the trades (and what doesn't), we realized other contractors needed the same playbook. So we started sharing it. Every strategy we recommend is one we've tested on our own business first. We know the slow seasons, the tire-kickers, and what it takes to close a $15K job. Veteran-owned, contractor-operated — we speak your language because we live your reality.`}
      learnMoreUrl="/about-us"
      showButton={false}
      image={{ src: aboutPageImage, alt: "Koi Roofing and Solar team" }}
    >
      <ContentRenderer query={query("mission-vision")} variant="MissionVisionVariant" />
  </AboutSection>

    <ContentRenderer query={query("values")} variant="WhyChooseUsVariant" />

    <!-- FAQ ContentRenderer -->
    <ContentRenderer
      query={query("faq").orderBy(sortByOrder())}
      variant="AccordionVariant"
      allowMultiple={false}
    />

    <!-- Contact ContentRenderer -->
    <CTASection>
      <!-- Multi-collection query - requires manual title/description -->
      <ContentRenderer
        query={query(["blog", "projects"]).orderBy(sortByDate()).limit(10)}
        variant="ListVariant"
        title="Recent Updates"
        description="Latest from our blog and portfolio"
      />
    </CTASection>
  </main>
</BaseLayout>
