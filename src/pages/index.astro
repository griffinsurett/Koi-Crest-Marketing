---
// src/pages/index.astro
import BaseLayout from "@/layouts/BaseLayout.astro";
import ContentRenderer from "@/components/ContentRenderer/ContentRenderer.astro";
import { siteData } from "@/content/siteData";
import {
  query,
  sortByDate,
  sortByOrder,
  whereArrayContains,
} from "@/utils/query";
import MainHero from "@/layouts/MainHero.astro";
import AboutSection from "@/layouts/AboutSection.astro";
import CTASection from "@/layouts/CTASection.astro";
import { byTag } from "@/utils/query/snippets";
import homeAboutImage from "@/assets/template-1.png";
---

<BaseLayout title={`${siteData.title} - home`} description={siteData.description}>
  <main class="flex-1">
    <!-- Hero ContentRenderer with static content -->
    <MainHero
      title={`${siteData.title} Marketing.`}
      description={siteData.description}
      subtitle={siteData.tagline}
      primaryCTA={{
        text: "Get Started",
        link: "/contact-us",
      }}
      secondaryCTA={{
        text: "View Services",
        link: "/services",
      }}
    />

    <AboutSection
      subtitle="About Us"
      title="Elevating Your Brand and helping you soar to new heights in the Digital World"
      description={`Our vision is to become a leading force in the marketing industry,
    recognized for our commitment to excellence, creativity, and integrity. We aim to shape
    the future of marketing by leveraging cutting-edge technology and data-driven insights,
    helping businesses of all sizes thrive in a rapidly evolving world. We envision a future
    where every brand we work with reaches its full potential through strategic, impactful
    marketing solutions.`}
      learnMoreUrl="/about-us"
      image={{ src: homeAboutImage, alt: "Marketing team celebrating new project success" }}
      
    >
  <div class="flex flex-col lg:flex-row gap-16 items-start">
      <!-- Left Column - Our Promise -->
      <div class="space-y-6 lg:w-3/5">
        <h3 class="h3 font-bold">Our Promise</h3>

        <p class="text-main text-gray-300 leading-relaxed">
          The promise of Koi Crest Marketing is to deliver innovative,
          results-driven marketing solutions tailored to each client's unique
          needs. As a veteran-owned agency, we are committed to providing
          exceptional service, building lasting partnerships, and helping
          businesses grow by connecting them with their audience through
          strategic, data-driven campaigns. Our focus is on delivering
          measurable results, ensuring that every project contributes to the
          long-term success of our clients.
        </p>
      </div>

      <!-- Right Column - Benefits (from content collection) -->
      <ContentRenderer query={query("benefits")} variant="BenefitsVariant" />
    </div>
  </AboutSection>

    <!-- Services - auto-populates from services meta -->
    <ContentRenderer
      query={byTag("services", "featured")}
      variant="ServicesVariant"
      columns={3}
      gap="lg"
    />

    <ContentRenderer
      query={query("reasons")}
      variant="WhyChooseUsVariant"
    />

    <!-- Filtered query - still gets meta from authors -->
    <!-- <ContentRenderer
      query={query("authors").where(whereArrayContains("tags", "featured"))}
      variant="GridVariant"
      columns={3}
      gap="lg"
    /> -->

    <!-- Portfolio with sorting -->
    <ContentRenderer
      query={query("projects")
        .orderBy(sortByDate("publishDate", "desc"))}
      variant="PortfolioVariant"
    />

    <!-- Testimonials with rating filter -->
    <ContentRenderer
      query={query("testimonials")}
      variant="TestimonialsVariant"
    />

    <!-- FAQ ContentRenderer -->
    <ContentRenderer
      query={query("faq").orderBy(sortByOrder())}
      variant="AccordionVariant"
      allowMultiple={false}
    />

    <!-- Contact ContentRenderer -->
    <CTASection>

    <!-- Multi-collection query - requires manual title/description -->
    <ContentRenderer
      query={query(["blog", "projects"]).orderBy(sortByDate()).limit(10)}
      variant="ListVariant"
      title="Recent Updates"
      description="Latest from our blog and portfolio"
    />
  </main>
</BaseLayout>
